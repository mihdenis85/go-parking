# Бэкенд для системы парковки

Бэкенд-сервис для управления доступностью парковочных мест.

## Содержание

* [Возможности](#возможности)
* [Требования](#требования)
* [Начало работы](#начало-работы)
* [Документация API](#документация-api)
* [Конфигурация](#конфигурация)
* [Зависимости](#зависимости)

## Возможности

* Пользователь может видеть, какие и сколько парковочных мест доступно.
* Пользователь может припарковать свой автомобиль.
* Пользователь может проверить свои занятые места и освободить их.
* Пользователь может просматривать статистику использования после освобождения парковочных мест.

## Требования

* [Docker](https://docs.docker.com/get-docker/)
* [Docker Compose](https://docs.docker.com/compose/install/)
* [Go](https://golang.org/dl/) (для запуска без Docker)

## Начало работы

1. **Клонируйте репозиторий:**

    ```bash
    git clone <your-repository-url>
    cd go-parking-backend
    ```

2. **Настройте переменные окружения:**
    Скопируйте пример файла окружения и заполните необходимые значения:

    ```bash
    cp .env.example .env
    ```

    Отредактируйте файл `.env` с вашей конкретной конфигурацией:
    * `PARKING_SERVICE_API_KEY`: Ваш уникальный API ключ для доступа к сервису.
    * `PARKING_SLOTS_COUNT`: Общее количество парковочных мест, управляемых системой.

3. **Соберите и запустите с Docker Compose:**
    Из корневой директории проекта выполните:

    ```bash
    docker-compose up --build -d
    ```

    API будет доступен по адресу `http://localhost:8000`.

## Запуск локально (без Docker)

1. **Установите зависимости:**

    ```bash
    go mod download
    ```

2. **Настройте MongoDB:**
    Убедитесь, что MongoDB запущена локально или обновите `MONGODB_URL` в `.env`, чтобы указать на ваш экземпляр MongoDB.

3. **Запустите приложение:**

    ```bash
    go run cmd/main.go
    ```

## Документация API

Эндпоинты API:

-`GET /parking/free-spaces-count` - Получить количество свободных мест
-`GET /parking/occupied-spaces-list` - Получить список занятых мест
-`POST /parking/park-car` - Припарковать автомобиль
-`POST /parking/free-up?place_number=<number>` - Освободить парковочное место
-`GET /parking/parking-space-logs?first_name=<name>&last_name=<name>` - Получить логи парковочных мест по имени

Все эндпоинты требуют заголовок `X-API-Key` с действительным API ключом.

Документация Swagger доступна по адресу: `http://localhost:8000/docs`.

## Конфигурация

Переменные окружения могут быть установлены в файле `.env` или как системные переменные окружения:

-`PARKING_SERVICE_API_KEY` (обязательно) - API ключ для аутентификации
-`PARKING_SLOTS_COUNT` - Общее количество парковочных мест (по умолчанию: 52)
-`MONGODB_URL` - URL подключения к MongoDB (по умолчанию: mongodb://mongodb:27017)
-`APP_TITLE` - Название приложения (по умолчанию: Parking Service)
-`DB_NAME` - Имя базы данных (по умолчанию: ParkingService)
-`SERVER_PORT` - Порт сервера (по умолчанию: 8000)

## Зависимости

Основные используемые библиотеки:

* Gin (HTTP веб-фреймворк)
* MongoDB Go Driver
* godotenv (Управление переменными окружения)
* google/uuid (Генерация UUID)
* swaggo/swag (Генерация Swagger документации)
* swaggo/gin-swagger (Интеграция Swagger с Gin)

Полный список см. в `go.mod`.
